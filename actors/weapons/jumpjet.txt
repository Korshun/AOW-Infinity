// Jumpjet Gatling gun
Actor JumpJetGatlingGun : GatlingGun {
	Obituary "$OB_GATLING_JET" // "%o was perforated by a flying %k's gatling gun."
	Weapon.AmmoType2 "JumpJetFuel"
	Weapon.AmmoUse2 1
	+ALT_AMMO_OPTIONAL
	DropItem "GatlingGun"
	Weapon.PreferredSkin "MarineChaingun"
	States
	{
	Ready:
		GATG A 1 A_WeaponReady
		GATG AA 0 A_JumpIfInventory("JumpJetSwitch", 1, "ReadyJumpJet")
		NULL A 0 A_StopSound(6)
		GATG AA 35 A_WeaponReady
		NULL A 0 A_StopSound(6)
		Goto Idle
	Idle:
		NULL A 0 SetPlayerProperty(0, 0, 3)
		NULL A 0 A_GiveInventory("JumpJetFuel", 1)
		GATG A 35 A_WeaponReady
		Loop
	ReadyJumpJet:
		GATG A 5 A_WeaponReady
		NULL A 0 SetPlayerProperty(0, 1, 3)
		NULL A 0 A_JumpIfInventory("JumpJetFuel", 1, "ReadyJumpJet")
		Goto AltFireOff
	Deselect:
		GATG A 1 A_Lower
		NULL A 0 A_JumpIfInventory("JumpJetSwitch", 1, "DeselectJumpJet")
		NULL A 0 A_StopSound(CHAN_WEAPON)
		NULL A 0 A_StopSound(6)
		Loop
	DeselectJumpJet:
		NULL A 0 A_PlaySound("jumpjet/Stop", 5)
		NULL A 0 A_StopSound(6)
		NULL A 0 SetPlayerProperty(0, 0, 3)
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		NULL A 0 A_TakeInventory("JumpJetSwitch", 1)
		Goto Deselect
	AltFire:
		NULL A 0 A_JumpIfInventory("JumpJetSwitch", 1, "AltFireOff")
		NULL A 0 A_JumpIfInventory("JumpJetFuel", 1, "AltFireGo")
		GATG A 35 A_WeaponReady(WRF_NOSECONDARY)
		Goto Ready
	AltFireGo:
		GATG A 70 A_PlaySound("jumpjet/start", 5)
		NULL A 0 SetPlayerProperty(0, 1, 3)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		NULL A 0 A_GiveInventory("JumpJetSwitch", 1)
		NULL A 0 ACS_ExecuteAlways(aow_jumpjetfueldrain, 0) // begin fuel drain
		NULL A 0 A_PlaySound("jumpjet/Loop", 6, 1.0, 1)
		Goto Ready
	AltFireOff:
		NULL A 0 A_PlaySound("jumpjet/Stop", 5)
		NULL A 0 A_StopSound(CHAN_WEAPON)
		NULL A 0 A_StopSound(6)
		NULL A 0 A_LowGravity
		GATG A 70 SetPlayerProperty(0, 0, 3)
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		NULL A 0 A_TakeInventory("JumpJetSwitch", 1)
		NULL A 0 A_Gravity
		Goto Ready
	Spawn:
		NULL A 0
		NULL A 0 A_SpawnItem("GatlingGun")
		Stop
	}
}

Actor JumpJetSwitch : Inventory {
		Inventory.amount 0
		Inventory.MaxAmount 1
}

Actor JumpJetCount : Inventory {
		Inventory.amount 0
		Inventory.MaxAmount 25
}

Actor JumpJetFuel : Ammo {
	Inventory.amount 1
	Inventory.MaxAmount 100
	Ammo.BackpackAmount 100
	Ammo.BackpackMaxAmount 100
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor JumpjetFire {
	+NOSECTOR +NOCLIP +NOINTERACTION +CLIENTSIDEONLY
	States
	{
	Spawn:
		NULL A 0
		NULL A 0 A_SpawnItemEx("OrcaFlame", 0, -5, 0, 0, 0, random(-9, -12))
		NULL A 0 A_SpawnItemEx("OrcaFlame", 0,  5, 0, 0, 0, random(-9, -12))
		Stop
	}
}

// [Dusk] Deactivates jumpjet forcibly
Actor JumpjetDeactivate : CustomInventory {
	+ALWAYSPICKUP +AUTOACTIVATE
	States
	{
	Spawn:
		NULL A 0
		Stop
	Pickup:
		NULL A 0 A_Gravity
		NULL A 0 A_StopSound(6)
		NULL A 0 SetPlayerProperty(0, 0, 3)
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		NULL A 5 A_TakeInventory("JumpJetSwitch", 1)
		Stop
	}
}