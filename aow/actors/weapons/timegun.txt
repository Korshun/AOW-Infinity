// TIME GUN
Actor TimeGun : AOWWeapon {
	+BLOODLESSIMPACT
	DropItem "NewBackpack"
	Obituary "%o was sucked in a time-space continuum vortex."
	Inventory.PickupMessage "\cGYOU HAS ACTIVATED THE TIMESPACE PARADOX D="
	Inventory.PickupSound "Weapons/Pickup"
	Weapon.AmmoGive 100
	Weapon.AmmoType "TimeGunAmmo"
	Weapon.AmmoUse 0
	Weapon.Kickback 25
	Weapon.PreferredSkin "MarineTimegun"
	AttackSound "mech/gauss"

	States
	{
	Spawn:
		NULL A 0
		Stop
	Ready:
		PSNG A 35 A_WeaponReady
		NULL A 0 A_GiveInventory("TimeGunAmmo", 5)
		Loop
	Deselect:
		PSNG A 1 A_Lower
		Loop
	Select:
		NULL A 0
		NULL A 0 ACS_ExecuteAlways(aow_script959, 0)
	SelectLoop:
		PSNG A 1 A_Raise
		Loop
	Fire:
		NULL A 0
		NULL A 0 A_JumpIfInventory("TimeGunRotation", 5, "Fire.Burst")
		NULL A 0 A_JumpIfInventory("TimeGunRotation", 4, "Fire.Teleport")
		NULL A 0 A_JumpIfInventory("TimeGunRotation", 3, "Fire.Weaken")
		NULL A 0 A_JumpIfInventory("TimeGunRotation", 2, "Fire.Slow")
		NULL A 0 A_JumpIfInventory("TimeGunRotation", 1, "Fire.Float")
		Goto Fire.Boost
	Fire.Boost:
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 25, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 25)
		NULL A 0 A_PlayWeaponSound("mech/gauss")
		NULL A 0 BRIGHT A_JumpIfInventory("IsBlue", 1, "Fire.BoostBlue")
		NULL A 0 A_FireBullets(0, 0, 1, 0, "BoostPuffRed", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlayWeaponSound("80mm/reload")
		Goto Ready
	Fire.BoostBlue:
		NULL A 0 BRIGHT
		NULL A 0 A_FireBullets(0, 0, 1, 0, "BoostPuffBlue", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlayWeaponSound("80mm/reload")
		Goto Ready
	Fire.Float:
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 25, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 25)
		NULL A 0 A_PlayWeaponSound("mech/gauss")
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Fire.FloatBlue")
		NULL A 0 A_FireBullets(0, 0, 1, 0, "FloatPuffRed", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.FloatBlue:
		NULL A 0 A_FireBullets(0, 0, 1, 0, "FloatPuffBlue", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.Slow:
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 25, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 25)
		NULL A 0 A_PlayWeaponSound("mech/gauss")
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Fire.SlowBlue")
		NULL A 0 A_FireBullets(0, 0, 1, 0, "SlowPuffRed", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.SlowBlue:
		NULL A 0 A_FireBullets(0, 0, 1, 0, "SlowPuffBlue", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.Weaken:
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 25, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 25)
		NULL A 0 A_PlayWeaponSound("mech/gauss")
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Fire.WeakenBlue")
		NULL A 0 A_FireBullets(0, 0, 1, 0, "WeakenPuffRed", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.WeakenBlue:
		NULL A 0 A_FireBullets(0, 0, 1, 0, "WeakenPuffBlue", 0)
		NULL A 0 A_ChangeFlag("PICKUP", 0)
		PSNG B 8 BRIGHT A_RailAttack(0, 0, 1, "FF 96 00", "FF D4 00", 0, 0, "GoldenPuff")
		NULL A 0 A_ChangeFlag("PICKUP", 1)
		PSNG A 35
		PSNG A 25 A_PlaySound("80mm/reload", CHAN_WEAPON)
		Goto Ready
	Fire.Teleport:
		PSNG C 27 BRIGHT A_PlayWeaponSound("plasmacannon/fire")
		// needed to prevent idiots from using timegun to run midfield without a class
		NULL A 0 A_JumpIfInventory("HasClass", 1, 1)
		Goto Nope
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 100, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 100)
		NULL A 0 A_PlaySound("misc/timewarp", CHAN_WEAPON)
		NULL A 0 A_Stop
		NULL A 0 A_SetTranslucent(0.5, 1)
		NULL A 0 SetPlayerProperty(0, 1, 0)
		NULL A 0 A_GiveInventory("GoldHue", 1)
		NULL A 0 A_SpawnItemEx("TimeGunFlareCluster")
		PSNG C 35 BRIGHT A_GiveInventory("IsTeleporting", 1)
		NULL A 0 A_JumpIfInventory("HasClass", 1, 1)
		Goto Nope
		NULL A 0 A_TakeInventory("IsInSpawnRoom", 1)
		PSNG A 3 BRIGHT ACS_ExecuteAlways(aow_script94, 0, random (0, 1))
		NULL A 0 A_SetTranslucent(1.0, 0)
		NULL A 0 A_SpawnItemEx("TimeGunFlareExplosion")
		NULL A 0 SetPlayerProperty(0, 0, 0)
		NULL A 0 A_TakeInventory("IsTeleporting", 1)
		PSNG A 35 BRIGHT A_PlaySound("misc/timeunwarp", CHAN_WEAPON)
		Goto Ready
	Nope:
		PSNG A 35 SetPlayerProperty(0, 0, 0)
		Goto Ready
	Fire.Burst:
		NULL A 0 A_JumpIfInventory("TimeGunCharged", 1, "BurstLoop")
		PSNG C 27 BRIGHT A_PlayWeaponSound("plasmacannon/fire")
		NULL A 0 A_GiveInventory("TimeGunCharged", 1)
		NULL A 0 A_StopSoundEx("Weapon")
	BurstLoop:
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "BurstLoopBlue")
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 5, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 5)
		NULL A 0 A_PlayWeaponSound("driver/fire")
		PSNG B 1 BRIGHT A_FireCustomMissile("GoldenBall1", random (-1.5, 1.5), 0, random (-2, 2), random (-2, 2))
		PSNG C 2
		NULL A 0 A_PlayWeaponSound("driver/fire")
		PSNG B 1 BRIGHT A_FireCustomMissile("GoldenBall2", random (-1.5, 1.5), 0, random (-2, 2), random (-2, 2))
		PSNG C 2
		NULL A 0 A_Refire
	BurstLoopBlue:
		NULL A 0 A_JumpIfInventory("TimeGunAmmo", 5, 1)
		Goto OutOfAmmo
		NULL A 0 A_TakeInventory("TimeGunAmmo", 5)
		NULL A 0 A_PlayWeaponSound("driver/fire")
		PSNG B 1 BRIGHT A_FireCustomMissile("GoldenBall1Blue", random (-1.5, 1.5), 0, random (-2, 2), random (-2, 2))
		PSNG C 2
		NULL A 0 A_PlayWeaponSound("driver/fire")
		PSNG B 1 BRIGHT A_FireCustomMissile("GoldenBall2Blue", random (-1.5, 1.5), 0, random (-2, 2), random (-2, 2))
		PSNG C 2
		NULL A 0 A_Refire
	OutOfAmmo:
		PSNG A 2 A_PlaySound("Plasma/FailFire", 6)
		NULL A 0 A_PlaySound("Plasma/Vapour", 7)
		NULL A 0 A_TakeInventory("TimeGunCharged", 1)
		PSNG AAAAAA 2 A_FireCustomMissile("OverheatSmokeSpawner", 0, 0, 6, -2)
		PSNG A 35
		Goto Ready
	AltFire:
		PSNG A 18 ACS_Execute(958, 0, 1)
		Goto Ready
	}
}

Actor IsTeleporting : Boolean {}

Actor TimeGunAmmo : Ammo {
	+IGNORESKILL
	Inventory.amount 175
	Inventory.MaxAmount 175
	Ammo.BackpackAmount 0
	Ammo.BackpackMaxAmount 175
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor TimeGunRotation : Inventory {Inventory.MaxAmount 5}
Actor TimeGunCharged : Inventory {Inventory.MaxAmount 1}

Actor Nope {
	+CLIENTSIDEONLY
	+NOGRAVITY
	RenderStyle translucent
	Alpha 1.0
	Scale 0.1
	States
	{
	Spawn:
		NULL A 0
		NULL A 0 A_PlaySound("misc/nope")
		NULL A 0 ThrustThingZ (0, 12, 0, 0)
		NOPE A 3 A_FadeOut(0.1)
		Wait
	}
}

// ===================================================
// ----------------------------------- EFFECT POWERUPS
// ===================================================

// BOOST
Actor PowerTimeGunBoost : PowerSpeed {
	Speed 1.4
	Powerup.Duration -15
}

Actor TimeGunBoost : PowerupGiver {
	+AUTOACTIVATE
	Inventory.MaxAmount 0
	Powerup.Type "TimeGunBoost"
	Inventory.pickupsound ""
	Powerup.Duration -15
	Powerup.Color GoldMap, 0.25
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor TimeGunBoostRed : CustomInventory {
	Inventory.MaxAmount 0
	Inventory.PickupMessage "`"
	Inventory.pickupsound "misc/p_pkup"
	States
	{
	Spawn:
		NULL A 5
		Stop
	Pickup:
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Failure")
		NULL A 0 A_JumpIfInventory("Knife", 1, "Failure")
		NULL A 0 A_JumpIfInventory("StealthLaserRifle", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 0) // intel message
		NULL A 0 A_GiveInventory("TimeGunBoost", 1)
		Stop
	Failure:
		NULL A 0
		Fail
	}
}

Actor TimeGunBoostBlue : TimeGunBoostRed {
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsRed", 1, "Failure")
		NULL A 0 A_JumpIfInventory("Knife", 1, "Failure")
		NULL A 0 A_JumpIfInventory("StealthLaserRifle", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 0) // intel message
		NULL A 0 A_GiveInventory("TimeGunBoost", 1)
		Stop
	}
}

// FLOAT
Actor TimeGunFloat : PowerupGiver {
	+AUTOACTIVATE
	Inventory.MaxAmount 0
	Inventory.pickupsound ""
	Powerup.Type "Flight"
	Powerup.Duration -20
	Powerup.Color GoldMap, 0.25
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor TimeGunFloatRed : TimeGunBoostRed {
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Failure")
		NULL A 0 A_JumpIfInventory("Knife", 1, "Failure")
		NULL A 0 A_JumpIfInventory("StealthLaserRifle", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 1) // intel message
		NULL A 0 A_GiveInventory("TimeGunFloat", 1)
		Stop
	}
}

Actor TimeGunFloatBlue : TimeGunBoostRed {
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsRed", 1, "Failure")
		NULL A 0 A_JumpIfInventory("Knife", 1, "Failure")
		NULL A 0 A_JumpIfInventory("StealthLaserRifle", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 1) // intel message
		NULL A 0 A_GiveInventory("TimeGunFloat", 1)
		Stop
	}
}

// SLOW
Actor PowerTimeGunSlow : PowerSpeed {
	Speed 0.6
}

Actor TimeGunSlow : PowerupGiver {
	+AUTOACTIVATE
	Inventory.MaxAmount 0
	Powerup.Type "TimeGunSlow"
	Inventory.pickupsound ""
	Powerup.Duration -20
	Powerup.Color "AA 00 00", 0.25
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor TimeGunSlowRed : TimeGunBoostRed {
	Inventory.pickupsound ""
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsRed", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 2) // intel message
		NULL A 0 A_GiveInventory("TimeGunSlow", 1)
		Stop
	}
}

Actor TimeGunSlowBlue : TimeGunBoostRed {
	Inventory.pickupsound ""
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 2) // intel message
		NULL A 0 A_GiveInventory("TimeGunSlow", 1)
		Stop
	}
}

// WEAKEN
Actor PowerTimeGunWeaken : PowerDamage {
	DamageFactor "Fist", 0.7
	DamageFactor "Fist", 0.7
	DamageFactor "Bullet", 0.7
	DamageFactor "Bullet", 0.7
	DamageFactor "Rifle", 0.7
	DamageFactor "Rifle", 0.7
	DamageFactor "Explosion", 0.7
	DamageFactor "Explosion", 0.7
	DamageFactor "Fire", 0.7
	DamageFactor "Fire", 0.7
	DamageFactor "Chemical", 0.7
	DamageFactor "Chemical", 0.7
	DamageFactor "Laser", 0.7
	DamageFactor "Laser", 0.7
	DamageFactor "RazorWire", 0.7
	DamageFactor "RazorWire", 0.7
	DamageFactor "ExplosionMech", 0.7
	DamageFactor "ExplosionMech", 0.7
	DamageFactor "TimeRed", 0.7
	DamageFactor "TimeBlue", 0.7
	DamageFactor "Disarm", 0.7
	DamageFactor "Flash", 0.7
	DamageFactor "Superweapon", 1.0
	DamageFactor "SuperweaponIon", 1.0
	DamageFactor "Slime", 1.0      //Mines
	DamageFactor "Artillery", 0.7
	DamageFactor "Artillery", 0.7
	DamageFactor "Mechstomp", 0.7
	DamageFactor "Monster", 0.7
	Powerup.Duration -15
}

Actor TimeGunWeaken : PowerupGiver {
	+AUTOACTIVATE
	Inventory.MaxAmount 0
	Powerup.Type "TimeGunWeaken"
	Inventory.pickupsound ""
	Powerup.Duration -20
	Powerup.Color "AA 00 00", 0.25
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor TimeGunWeakenRed : TimeGunBoostRed {
	Inventory.pickupsound ""
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsRed", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 3) // intel message
		NULL A 0 A_GiveInventory("TimeGunWeaken", 1)
		Stop
	}
}

Actor TimeGunWeakenBlue : TimeGunBoostRed {
	Inventory.pickupsound ""
	States
	{
	Pickup:
		NULL A 0 A_JumpIfInventory("IsBlue", 1, "Failure")
		NULL A 0 ACS_Execute(958, 0, 0, 3) // intel message
		NULL A 0 A_GiveInventory("TimeGunWeaken", 1)
		Stop
	}
}

// ===================================================
// --------------------------------- BURST PROJECTILES
// ===================================================
Actor GoldenBall1 : PlasmaShot {
	+FORCEXYBILLBOARD
	+SEEKERMISSILE
	Obituary "%o was blasted out of timestream by %k's time gun."
	Translation "192:207=160:167", "240:246=232:235", "80:111=160:167"
	DamageType "TimeRed"
	Damage (10)
	Speed 25
	RenderStyle add
	Alpha 0.75
	States
	{
	Spawn:
		PLSS AB 4 BRIGHT A_Tracer2
		Loop
	}
}

Actor GoldenBall2 : DoomImpBall {
	+FORCEXYBILLBOARD
	+SEEKERMISSILE
	Obituary "%o was blasted out of timestream by %k's time gun."
	Translation "176:191=160:167", "208:223=160:167", "16:47=160:167"
	DamageType "TimeRed"
	Damage (10)
	Speed 25
	FastSpeed 25
	RenderStyle add
	Alpha 0.75
	States
	{
	Spawn:
		BAL1 AB 4 BRIGHT // A_Tracer2
		Loop
	}
}

Actor GoldenBall1Blue : GoldenBall1 {DamageType "TimeBlue"}
Actor GoldenBall2Blue : GoldenBall2 {DamageType "TimeBlue"}

// ===================================================
// -------------------------------------- EFFECT PUFFS
// ===================================================
Actor GoldenPuff {
	+PUFFONACTORS
	+NOBLOCKMAP
	+NOGRAVITY
	+BLOODLESSIMPACT
	+PUFFGETSOWNER
	RenderStyle Add
	Alpha 0.75
	Translation "192:207=160:167", "240:246=232:235", "80:111=160:167"

	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor BoostPuffRed : GoldenPuff {
	DamageType "TimeRed"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunBoostRed", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor BoostPuffBlue : GoldenPuff {
	DamageType "TimeBlue"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunBoostBlue", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor FloatPuffRed : GoldenPuff {
	DamageType "TimeRed"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunFloatRed", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor FloatPuffBlue : GoldenPuff {
	DamageType "TimeBlue"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunFloatBlue", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor SlowPuffRed : GoldenPuff {
	DamageType "TimeRed"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunSlowRed", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor SlowPuffBlue : GoldenPuff {
	DamageType "TimeBlue"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunSlowBlue", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor WeakenPuffRed : GoldenPuff {
	DamageType "TimeRed"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunWeakenRed", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

Actor WeakenPuffBlue : GoldenPuff {
	DamageType "TimeBlue"
	States
	{
	Spawn:
	Melee:
	Crash:
		VOLX AA 0 A_SpawnItem("TimeGunWeakenBlue", -1)
		NULL A 0 A_Explode(5, 16)
		VOLX ABCDEFEDCBA 3 BRIGHT
		Stop
	}
}

// ===================================================
// ----------------------------------- SPECIAL EFFECTS
// ===================================================

// flare effects for teleportation
Actor TimeGunFlareCluster {
	+CLIENTSIDEONLY +NOINTERACTION
	ReactionTime 19
	States
	{
	Spawn:
		NULL A 0
		TNT1 AAAAAAAA 0 A_SpawnItemEx("TimeGunFlare", random(-64, 64), random(-64, 64), random(0, 128), 0, 0, 1)
		NULL A 2
		NULL A 0 A_Countdown
		Loop
	Death:
		NULL A 0 A_SpawnItemEx("TimeGunFlareExplosion")
		Stop
	}
}

Actor TimeGunFlareExplosion {
	+CLIENTSIDEONLY +NOINTERACTION
	States
	{
	Spawn:
		NULL A 0
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("TimeGunFlareGravity", 0, 0, 0, random (-12, 12), random (-12, 12), random (4, 9))
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("TimeGunFlareGravity", 0, 0, 0, random (-12, 12), random (-12, 12), random (4, 9))
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("TimeGunFlareGravity", 0, 0, 0, random (-12, 12), random (-12, 12), random (4, 9))
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("TimeGunFlareGravity", 0, 0, 0, random (-12, 12), random (-12, 12), random (4, 9))
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("TimeGunFlareGravity", 0, 0, 0, random (-12, 12), random (-12, 12), random (4, 9))
		NULL A 2 A_SpawnItemEx("GoldBeam")
		Stop
	}
}

Actor TimeGunFlare : IonRainFlare {
	+FORCEXYBILLBOARD
	Scale 0.04
	Translation "192:207=160:167", "240:246=232:235", "80:111=160:167"
}

Actor TimeGunFlareGravity : TimeGunFlare {-NOGRAVITY -NOINTERACTION}

Actor GoldBeam : BlueBeam {
	XScale 1.0
	YScale 3.0
	Alpha 0.2
	States
	{
	Spawn:
		NULL A 0
		SBGL AAAA 1 A_FadeIn(0.2)
		SBGL A 1 BRIGHT A_FadeOut(0.05)
		Wait
	}
}

// hues
Actor GoldHue : PowerupGiver {
	+INVENTORY.AUTOACTIVATE
	Inventory.PickupMessage "wat are you doing"
	Inventory.MaxAmount 0
	Powerup.Color GoldMap
	Powerup.Duration -1
	Powerup.Type "Null"
	States
	{
	Spawn:
		NULL A 0
		Stop
	}
}

Actor PlayerSpeedTrail2 replaces PlayerSpeedTrail {
	+NOBLOCKMAP
	RenderStyle None
	Alpha 0.0
	Scale 0.0
}